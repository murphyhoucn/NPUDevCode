#!/bin/bash

# ==============================================================================
# 脚本名称: calculate_dir_sizes.sh
# 描述:     计算指定目录下第一层所有子目录的大小。
# 作者:     Gemini
# 日期:     2025-09-04
# ==============================================================================

# 定义要扫描的目标目录
TARGET_DIR="/mnt"

# --- 主逻辑 ---

# 检查目标目录是否存在
if [ ! -d "$TARGET_DIR" ]; then
  echo "错误: 目录 ${TARGET_DIR} 不存在。"
  exit 1
fi

echo "正在计算目录 [${TARGET_DIR}] 下所有文件夹的大小..."
echo "--------------------------------------------------"

# 循环遍历目标目录下的每一个项目
# 使用 find 命令可以更精确地只选择目录，避免处理文件
# -mindepth 1 -maxdepth 1 确保只处理第一层子目录
find "${TARGET_DIR}" -mindepth 1 -maxdepth 1 -type d | while read -r dir; do
    # 使用 sudo du -sh 计算每个目录的总大小
    # -s (summarize) 表示只显示总计大小
    # -h (human-readable) 表示使用易读格式 (K, M, G)
    sudo du -sh "${dir}"
done

echo "--------------------------------------------------"
echo "计算完成。"
